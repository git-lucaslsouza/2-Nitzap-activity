<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Execute Endpoint</title>
  <script src="https://assets.sfdc-static.com/marketingcloud/interactive/js/postmonger.js"></script>
</head>
<body>
  <script>
    console.log('ðŸŸ¢ Execute endpoint initialized');

    var connection = new Postmonger.Session();

    connection.on('request', function(data) {
      console.log('ðŸ“¥ Request received from Journey Builder:', data);
    });

    connection.on('initActivity', function(payload) {
      console.log('ðŸ”„ Activity initialized with payload:', payload);

      // Simulate message sending
      const marketingText = payload.arguments.execute.inArguments[0].messageText || 'Default message';
      console.log('ðŸ“¤ Sending message to Nitzap API: ', marketingText);

      // Optionally simulate sending via fetch:
      // fetch('https://your-nitzap-api.com/send', {
      //   method: 'POST',
      //   headers: { 'Content-Type': 'application/json' },
      //   body: JSON.stringify({ message: marketingText })
      // });

      // Let Journey Builder know the activity executed successfully
      connection.trigger('updateActivity', payload);
    });

    // Tell Journey Builder this activity is ready to be initialized
    connection.trigger('ready');
  </script>

  <p><strong>Execute Handler:</strong> Simulated WhatsApp message. Check browser console for logs.</p>
</body>
</html>
